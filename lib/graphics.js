!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var i in n)("object"==typeof exports?exports:t)[i]=n[i]}}(window,function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(i,s,function(e){return t[e]}.bind(null,s));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=10)}([function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n=function(t,e){var n=t[1]||"",i=t[3];if(!i)return n;if(e&&"function"==typeof btoa){var s=(r=i,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),o=i.sources.map(function(t){return"/*# sourceURL="+i.sourceRoot+t+" */"});return[n].concat(o).concat([s]).join("\n")}var r;return[n].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n}).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},s=0;s<this.length;s++){var o=this[s][0];null!=o&&(i[o]=!0)}for(s=0;s<t.length;s++){var r=t[s];null!=r[0]&&i[r[0]]||(n&&!r[2]?r[2]=n:n&&(r[2]="("+r[2]+") and ("+n+")"),e.push(r))}},e}},function(t,e,n){var i,s,o={},r=(i=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===s&&(s=i.apply(this,arguments)),s}),a=function(t){var e={};return function(t,n){if("function"==typeof t)return t();if(void 0===e[t]){var i=function(t,e){return e?e.querySelector(t):document.querySelector(t)}.call(this,t,n);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}}(),h=null,c=0,d=[],u=n(7);function l(t,e){for(var n=0;n<t.length;n++){var i=t[n],s=o[i.id];if(s){s.refs++;for(var r=0;r<s.parts.length;r++)s.parts[r](i.parts[r]);for(;r<i.parts.length;r++)s.parts.push(w(i.parts[r],e))}else{var a=[];for(r=0;r<i.parts.length;r++)a.push(w(i.parts[r],e));o[i.id]={id:i.id,refs:1,parts:a}}}}function v(t,e){for(var n=[],i={},s=0;s<t.length;s++){var o=t[s],r=e.base?o[0]+e.base:o[0],a={css:o[1],media:o[2],sourceMap:o[3]};i[r]?i[r].parts.push(a):n.push(i[r]={id:r,parts:[a]})}return n}function p(t,e){var n=a(t.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=d[d.length-1];if("top"===t.insertAt)i?i.nextSibling?n.insertBefore(e,i.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),d.push(e);else if("bottom"===t.insertAt)n.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var s=a(t.insertAt.before,n);n.insertBefore(e,s)}}function f(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=d.indexOf(t);e>=0&&d.splice(e,1)}function g(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var i=function(){0;return n.nc}();i&&(t.attrs.nonce=i)}return m(e,t.attrs),p(t,e),e}function m(t,e){Object.keys(e).forEach(function(n){t.setAttribute(n,e[n])})}function w(t,e){var n,i,s,o;if(e.transform&&t.css){if(!(o="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=o}if(e.singleton){var r=c++;n=h||(h=g(e)),i=b.bind(null,n,r,!1),s=b.bind(null,n,r,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",m(e,t.attrs),p(t,e),e}(e),i=function(t,e,n){var i=n.css,s=n.sourceMap,o=void 0===e.convertToAbsoluteUrls&&s;(e.convertToAbsoluteUrls||o)&&(i=u(i));s&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */");var r=new Blob([i],{type:"text/css"}),a=t.href;t.href=URL.createObjectURL(r),a&&URL.revokeObjectURL(a)}.bind(null,n,e),s=function(){f(n),n.href&&URL.revokeObjectURL(n.href)}):(n=g(e),i=function(t,e){var n=e.css,i=e.media;i&&t.setAttribute("media",i);if(t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}.bind(null,n),s=function(){f(n)});return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else s()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=r()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=v(t,e);return l(n,e),function(t){for(var i=[],s=0;s<n.length;s++){var r=n[s];(a=o[r.id]).refs--,i.push(a)}t&&l(v(t,e),e);for(s=0;s<i.length;s++){var a;if(0===(a=i[s]).refs){for(var h=0;h<a.parts.length;h++)a.parts[h]();delete o[a.id]}}}};var x,y=(x=[],function(t,e){return x[t]=e,x.filter(Boolean).join("\n")});function b(t,e,n,i){var s=n?"":i.css;if(t.styleSheet)t.styleSheet.cssText=y(e,s);else{var o=document.createTextNode(s),r=t.childNodes;r[e]&&t.removeChild(r[e]),r.length?t.insertBefore(o,r[e]):t.appendChild(o)}}},function(t,e,n){var i=n(6);"string"==typeof i&&(i=[[t.i,i,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};n(2)(i,s);i.locals&&(t.exports=i.locals)},function(t,e,n){"use strict";(function(t){var n=function(){if("undefined"!=typeof Map)return Map;function t(t,e){var n=-1;return t.some(function(t,i){return t[0]===e&&(n=i,!0)}),n}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var n=t(this.__entries__,e),i=this.__entries__[n];return i&&i[1]},e.prototype.set=function(e,n){var i=t(this.__entries__,e);~i?this.__entries__[i][1]=n:this.__entries__.push([e,n])},e.prototype.delete=function(e){var n=this.__entries__,i=t(n,e);~i&&n.splice(i,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){void 0===e&&(e=null);for(var n=0,i=this.__entries__;n<i.length;n++){var s=i[n];t.call(e,s[1],s[0])}},e}()}(),i="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,s=void 0!==t&&t.Math===Math?t:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),o="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(s):function(t){return setTimeout(function(){return t(Date.now())},1e3/60)},r=2;var a=20,h=["top","right","bottom","left","width","height","size","weight"],c="undefined"!=typeof MutationObserver,d=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(t,e){var n=!1,i=!1,s=0;function a(){n&&(n=!1,t()),i&&c()}function h(){o(a)}function c(){var t=Date.now();if(n){if(t-s<r)return;i=!0}else n=!0,i=!1,setTimeout(h,e);s=t}return c}(this.refresh.bind(this),a)}return t.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},t.prototype.removeObserver=function(t){var e=this.observers_,n=e.indexOf(t);~n&&e.splice(n,1),!e.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},t.prototype.updateObservers_=function(){var t=this.observers_.filter(function(t){return t.gatherActive(),t.hasActive()});return t.forEach(function(t){return t.broadcastActive()}),t.length>0},t.prototype.connect_=function(){i&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),c?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){i&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(t){var e=t.propertyName,n=void 0===e?"":e;h.some(function(t){return!!~n.indexOf(t)})&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),u=function(t,e){for(var n=0,i=Object.keys(e);n<i.length;n++){var s=i[n];Object.defineProperty(t,s,{value:e[s],enumerable:!1,writable:!1,configurable:!0})}return t},l=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||s},v=x(0,0,0,0);function p(t){return parseFloat(t)||0}function f(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.reduce(function(e,n){return e+p(t["border-"+n+"-width"])},0)}function g(t){var e=t.clientWidth,n=t.clientHeight;if(!e&&!n)return v;var i=l(t).getComputedStyle(t),s=function(t){for(var e={},n=0,i=["top","right","bottom","left"];n<i.length;n++){var s=i[n],o=t["padding-"+s];e[s]=p(o)}return e}(i),o=s.left+s.right,r=s.top+s.bottom,a=p(i.width),h=p(i.height);if("border-box"===i.boxSizing&&(Math.round(a+o)!==e&&(a-=f(i,"left","right")+o),Math.round(h+r)!==n&&(h-=f(i,"top","bottom")+r)),!function(t){return t===l(t).document.documentElement}(t)){var c=Math.round(a+o)-e,d=Math.round(h+r)-n;1!==Math.abs(c)&&(a-=c),1!==Math.abs(d)&&(h-=d)}return x(s.left,s.top,a,h)}var m="undefined"!=typeof SVGGraphicsElement?function(t){return t instanceof l(t).SVGGraphicsElement}:function(t){return t instanceof l(t).SVGElement&&"function"==typeof t.getBBox};function w(t){return i?m(t)?function(t){var e=t.getBBox();return x(0,0,e.width,e.height)}(t):g(t):v}function x(t,e,n,i){return{x:t,y:e,width:n,height:i}}var y=function(){function t(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=x(0,0,0,0),this.target=t}return t.prototype.isActive=function(){var t=w(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},t}(),b=function(){return function(t,e){var n,i,s,o,r,a,h,c=(i=(n=e).x,s=n.y,o=n.width,r=n.height,a="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,h=Object.create(a.prototype),u(h,{x:i,y:s,width:o,height:r,top:s,right:i+o,bottom:r+s,left:i}),h);u(this,{target:t,contentRect:c})}}(),C=function(){function t(t,e,i){if(this.activeObservations_=[],this.observations_=new n,"function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=e,this.callbackCtx_=i}return t.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof l(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new y(t)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof l(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach(function(e){e.isActive()&&t.activeObservations_.push(e)})},t.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map(function(t){return new b(t.target,t.broadcastRect())});this.callback_.call(t,e,t),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),E="undefined"!=typeof WeakMap?new WeakMap:new n,P=function(){return function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=d.getInstance(),i=new C(e,n,this);E.set(this,i)}}();["observe","unobserve","disconnect"].forEach(function(t){P.prototype[t]=function(){var e;return(e=E.get(this))[t].apply(e,arguments)}});var N=void 0!==s.ResizeObserver?s.ResizeObserver:P;e.a=N}).call(this,n(8))},function(t,e,n){var i=n(9);"string"==typeof i&&(i=[[t.i,i,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};n(2)(i,s);i.locals&&(t.exports=i.locals)},function(t,e,n){(e=t.exports=n(1)(!1)).push([t.i,".style-18Hmg {\n  background: white;\n  position: fixed;\n  width: 160px;\n  min-height: 160px;\n  border-radius: 5px;\n  z-index: 9999;\n  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);\n  border: 1px solid rgba(0, 0, 0, 0.15);\n  font-size: 14px;\n  padding: 10px 0;\n  color: #666;\n}\n.style-18Hmg .item {\n  height: 26px;\n  line-height: 26px;\n  padding: 3px 20px;\n  cursor: pointer;\n}\n.style-18Hmg .item:hover {\n  background: #f6f6f6;\n  color: #0796e9;\n}\n",""]),e.locals={menu:"style-18Hmg"}},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,i=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var s,o=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(o)?t:(s=0===o.indexOf("//")?o:0===o.indexOf("/")?n+o:i+o.replace(/^\.\//,""),"url("+JSON.stringify(s)+")")})}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){(e=t.exports=n(1)(!1)).push([t.i,".canvas-1iCxA {\n  width: 100%;\n  height: 100%;\n  position: relative;\n}\n.canvas-1iCxA > div,\n.canvas-1iCxA canvas {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  overflow: hidden;\n}\n.canvas-1iCxA .hidden {\n  display: none !important;\n}\n",""]),e.locals={topology:"canvas-1iCxA"}},function(t,e,n){"use strict";n.r(e);var i=n(0),s=n.n(i),o=n(3),r=n.n(o);class a{static copy(t){return h>d.length-1&&(h=0),d[h++].copy(t)}constructor(t=0,e=0){s()(this,"x",void 0),s()(this,"y",void 0),this.x=t,this.y=e}get magnitude(){return this.getMagnitude()}getMagnitude(){return 0===this.x&&0===this.y?1e-9:Math.sqrt(this.x*this.x+this.y*this.y)}add(t){return this.x+=t.x,this.y+=t.y,this}substract(t){return this.x-=t.x,this.y-=t.y,this}dotProduct(t){return this.x*t.x+this.y*t.y}crossProduct(t){return this.x*t.y-this.y*t.x}scale(t){return this.x*=t,this.y*=t,this}edge(t){return this.clone().substract(t)}perpendicular(){return new a(this.y,-this.x)}normalize(){return new a(this.x/this.magnitude,this.y/this.magnitude)}normal(){return this.perpendicular().normalize()}cosAngle(t){return this.dotProduct(t)/(this.magnitude*t.magnitude)}angle(t){return Math.acos(this.cosAngle(t))}xAxisAngle(){const t=this.angle(a.xAxis);return this.y>0?t:-t}rotate(t){const{x:e,y:n}=this;return this.x=e*Math.cos(t)-n*Math.sin(t),this.y=e*Math.sin(t)+n*Math.cos(t),this}project(t){const e=this.dotProduct(t)/t.magnitude;return t.normalize().clone().scale(e)}equal(t){return this.x===t.x&&this.y===t.y}distance(t){return this.edge(t).magnitude}copy(t){return this.x=t.x,this.y=t.y,this}clone(){return new a(this.x,this.y)}}s()(a,"xAxis",new a(1,0)),s()(a,"yAxis",new a(0,1));let h=0,c=200;const d=[];for(;c--;)d.push(new a);var u=a;const l=[{label:"放大",command:"zoomIn"},{label:"缩小",command:"zoomOut"}];class v{constructor(t){s()(this,"mouseX",0),s()(this,"mouseY",0),s()(this,"canvas",void 0),s()(this,"mounted",!1),s()(this,"container",document.createElement("div")),s()(this,"menu",l),s()(this,"handleClick",t=>{t.stopPropagation();const e=t.target;if(!e)return;if(e===this.container)return;const n=e.dataset.command;switch(n){case"zoomIn":this.canvas.zoomIn(new a(this.mouseX,this.mouseY));break;case"zoomOut":this.canvas.zoomOut(new a(this.mouseX,this.mouseY));break;default:this.canvas.eventEmitter.emit("canvas:menu",n)}this.hide()}),s()(this,"handleDocumentClick",t=>{this.hide()}),this.canvas=t,this.container.className=r.a.menu,this.container.addEventListener("click",this.handleClick),document.addEventListener("click",this.handleDocumentClick)}destroy(){this.container.removeEventListener("click",this.handleClick),document.removeEventListener("click",this.handleDocumentClick),this.unmount()}show(t,e){this.mouseX=t,this.mouseY=e;let n=t,i=e;Object.assign(this.container.style,{left:`${n}px`,top:`${i}px`}),this.mount()}hide(){this.unmount()}mount(){if(this.mounted)return;const t=[...this.menu].map(t=>`<div class="item" data-command="${t.command}">${t.label}</div>`);this.container.innerHTML=t.join(""),document.body.appendChild(this.container),this.mounted=!0}unmount(){this.mounted&&(document.body.removeChild(this.container),this.mounted=!1)}}class p{constructor(){s()(this,"events",{})}on(t,e){this.events[t]=this.events[t]||[],this.events[t].push(e)}off(t,e){if(!this.events[t])return;const n=this.events[t].findIndex(t=>t===e);this.events[t].splice(n,1)}emit(t,e){this.events[t]&&this.events[t].forEach(t=>{t(e)})}}const f=new p;let g=1;var m=class{constructor(t){s()(this,"canvas",void 0),s()(this,"active",!1),s()(this,"visible",void 0),s()(this,"zIndex",void 0),s()(this,"isUpdate",!0),s()(this,"graphId",g++),s()(this,"data",void 0),s()(this,"renderSign",void 0),this.visible=t.visible||!0,this.zIndex=t.zIndex||0,this.data=t.data}isInRect(t){return!1}isWrappedInRect(t){return!1}render(){}update(){}destroy(){}beforeDestroy(){}};class w extends m{constructor(t){super(t),s()(this,"id",void 0),s()(this,"position",void 0),s()(this,"renderType",void 0),s()(this,"shapeType",void 0),s()(this,"isGroup",!1),s()(this,"canResize",!1),s()(this,"children",[]),s()(this,"parent",void 0),s()(this,"edges",[]),this.position=new a(t.x,t.y),this.id=t.id}translate(t){this.position.add(t),this.isUpdate=!0,this.children.forEach(e=>{e.translate(t)})}addEdge(t){this.edges.find(e=>e===t)||this.edges.push(t)}removeEdge(t){const e=this.edges.findIndex(e=>e===t);e>-1&&this.edges.splice(e,1)}addChild(t){if(this.hasChild(t))return;let e=this.children.length-1,n=this.children[e];for(;n;){if(n.zIndex<=t.zIndex)return this.addChildAt(t,e+1);e--,n=this.children[e]}return this.addChildAt(t,0)}addChildAt(t,e){return e>=0&&e<=this.children.length?(t.parent=this,this.children.splice(e,0,t),this.canvas&&(t.canvas=this.canvas,t.render(),t.getDescendantBF(t=>{t.canvas=this.canvas,t.render()})),t):void 0}removeChild(t,e=!0){const n=this.children.findIndex(e=>e===t);return-1!==n&&(e&&t.destroy(),t.canvas=void 0,this.children.splice(n,1),!0)}removeAllChild(t=!0){[...this.children].forEach(e=>{this.removeChild(e,t)})}hasChild(t){return!!this.children.find(e=>e===t)}hasDescendant(t){let e=!1;return this.getDescendantBF(n=>{if(n===t)return e=!0}),e}getChildById(t){return this.children.find(e=>e.id===t)}getActiveChild(){return this.children.filter(t=>t.active)}getActiveDescendant(){const t=[];return this.getDescendantBF(e=>{e.active&&t.push(e)}),t}getDescendantDF(t){let e=!1;const n=[];return function t(i){for(let s=this.children.length-1;s>=0;s--){const o=this.children[s];if(t.call(o,i),e)return n;if(n.push(o),i&&i(o))return e=!0,n}return n}.call(this,t)}getDescendantBF(t){const e=[],n=[...this.children];for(;n.length;){const i=n.shift();if(e.push(i),n.push(...i.children),t&&t(i))break}return e}get root(){let t=this;for(;void 0!==t.parent;)t=t.parent;return t}get depth(){let t=0,e=this;for(;void 0!==e.parent;)e=e.parent,t++;return t}get firstChild(){return this.children[0]}get lastChild(){return this.children[this.children.length-1]}}var x=w;class y extends x{constructor(t){super(t),s()(this,"renderType","CANVAS"),s()(this,"cacheCanvas",document.createElement("canvas"))}destroy(){this.beforeDestroy()}}var b=y;class C extends x{constructor(t){super(t),s()(this,"renderType","DOM"),s()(this,"mounted",!1),s()(this,"$el",document.createElement("div")),Object.assign(this.$el.style,{position:"absolute",left:0,top:0})}mount(){!this.mounted&&this.canvas&&(this.mounted=!0,this.canvas.domCanvas.appendChild(this.$el))}unmount(){this.mounted&&this.canvas&&(this.mounted=!1,this.canvas.domCanvas.removeChild(this.$el))}isPointIn(){const{canvas:t}=this;if(!t)return!1;if(!t.nativeEvent)return!1;let e=t.nativeEvent.target,n=!1;for(;e&&!n;)e===this.$el&&(n=!0),e=e.parentElement;return n}update(){const{x:t,y:e}=this.position;this.$el.style.transform=`translate3d(${t}px,${e}px,0)`}destroy(){this.beforeDestroy(),this.unmount()}}var E=C;function P(t){let e=!1;return function(...n){e||(e=!0,t(...n),requestAnimationFrame(()=>{e=!1}))}}function N(t){return new Promise((e,n)=>{const i=new Image;i.src=t,i.onload=(()=>{e(i)}),i.onerror=(()=>{n()})})}function M(t,e){e.forEach(e=>{Object.getOwnPropertyNames(e.prototype).forEach(n=>{"constructor"!==n&&(t.prototype[n]=e.prototype[n])})})}var _=n(4);var I=class extends x{constructor(t){super(t),s()(this,"renderType","NONE"),s()(this,"shapeType","circle"),s()(this,"radius",0)}get vertexes(){return[this.position,this.position,this.position,this.position]}get boundingRect(){return[this.position,this.position,this.position,this.position]}get boundingJoinPoints(){return[this.position]}get joinPoint(){return this.position}get centerPoint(){return this.position}get depth(){return Number.MAX_SAFE_INTEGER}isInRect(){return!1}isPointIn(){return!1}render(){}destroy(){}updatePosition(){}updateRender(){}};function T(t,e){}function A(t){}class D{constructor(){s()(this,"onClick",T),s()(this,"onMouseDown",T),s()(this,"onMouseMove",T),s()(this,"onMouseUp",T),s()(this,"onDrop",T),s()(this,"onDragOver",T),s()(this,"onWheel",T),s()(this,"onContextMenu",T),s()(this,"onInstall",A),s()(this,"onUninstall",A),s()(this,"onUpdate",A)}}var R=D;let S=new u;const O=new class extends R{constructor(...t){super(...t),s()(this,"minDragDistance",1),s()(this,"moveNodes",[]),s()(this,"mousedown",!1),s()(this,"lastCoordinate",new u),s()(this,"onMouseDown",t=>{const e=t.getActiveNodes();e.length?this.moveNodes=[...e]:this.moveNodes=[...t.rootNode.children],this.mousedown=!0,this.lastCoordinate=t.mousedownPosition}),s()(this,"onMouseMove",t=>{if(!this.mousedown)return;S.copy(t.mousemovePosition);const e=S.substract(this.lastCoordinate);if(this.lastCoordinate=t.mousemovePosition,e.magnitude<this.minDragDistance)return;const n=e.scale(1/t.canvasScale);this.moveNodes.forEach(t=>{t.translate(n)}),t.repaint=!0}),s()(this,"onMouseUp",t=>{this.moveNodes=[],this.mousedown=!1})}};var L=O;const k=new class extends R{constructor(...t){super(...t),s()(this,"onDrop",(t,e)=>{const n=e;t.eventEmitter.emit("canvas:drop",{coordinate:t.viewportToPixelCoordinate(new a(n.clientX,n.clientY)),dataTransfer:n.dataTransfer})}),s()(this,"onDragOver",(t,e)=>{e.preventDefault()})}};var z=k;let B=new a;const U=new class extends R{constructor(...t){super(...t),s()(this,"minDragDistance",1),s()(this,"moveNodes",[]),s()(this,"mouseDown",!1),s()(this,"move",!1),s()(this,"lastCoordinate",new a),s()(this,"onMouseDown",t=>{this.mouseDown=!0,this.moveNodes=[...t.rootNode.children],this.lastCoordinate=t.mousedownPosition}),s()(this,"onMouseMove",t=>{if(!this.mouseDown)return;B.copy(t.mousemovePosition);const e=B.substract(this.lastCoordinate);if(this.lastCoordinate=t.mousemovePosition,e.magnitude<this.minDragDistance)return;this.move=!0;const n=e.scale(1/t.canvasScale);this.moveNodes.forEach(t=>{t.translate(n)}),t.repaint=!0}),s()(this,"onMouseUp",t=>{this.moveNodes=[],this.mouseDown=!1,this.move&&(t.eventEmitter.emit("interaction:canvasMoveEnd"),this.move=!1)})}};var W=U;const j=new class extends R{constructor(...t){super(...t),s()(this,"onWheel",(t,e)=>{const{deltaY:n,clientX:i,clientY:s}=e;n>0?t.zoomOut(new a(i,s)):t.zoomIn(new a(i,s))})}};var H=j;class F extends m{constructor(t){super(t),s()(this,"renderType","CANVAS"),s()(this,"targetNode",void 0),s()(this,"sourceNode",void 0),this.targetNode=t.targetNode,this.sourceNode=t.sourceNode}}class J{static isPointInRect(t,e,n,i){return!(t.x<e.x)&&(!(t.y<e.y)&&(!(t.x>e.x+n)&&!(t.y>e.y+i)))}static isPointInCircle(t,e,n){return a.copy(e).substract(t).magnitude<=n}static isPointInTriangle(t,e,n,i){const s=a.copy(e).substract(t),o=a.copy(n).substract(t),r=a.copy(i).substract(t),h=s.crossProduct(o)<0,c=o.crossProduct(r)<0,d=r.crossProduct(s)<0;return h===c&&c===d}static isPointInPolygon(t,e){if(e.length<3)return!1;for(let n=2;n<e.length;n++)if(J.isPointInTriangle(t,e[0],e[n-1],e[n]))return!0;return!1}static isPointInLineSegment(t,e,n=.01){const i=e[0],s=e[1],o=a.copy(t).substract(i),r=a.copy(t).substract(s),h=a.copy(i).substract(s);return o.magnitude+r.magnitude-h.magnitude<n}static isPointInPolyline(t,e,n=.01){const i=e.length;if(i<2)return!1;for(let s=1;s<i;s++)if(J.isPointInLineSegment(t,[e[s-1],e[s]],n))return!0;return!1}static isIntersect(t,e){const n=t[0],i=t[1],s=e[0],o=e[1];if(J.isPointInLineSegment(n,e))return!0;if(J.isPointInLineSegment(i,e))return!0;if(J.isPointInLineSegment(s,t))return!0;if(J.isPointInLineSegment(o,t))return!0;const r=a.copy(s).substract(n),h=a.copy(o).substract(n),c=a.copy(s).substract(i),d=a.copy(o).substract(i);if(r.crossProduct(h)<0===c.crossProduct(d)<0)return!1;const u=a.copy(n).substract(s),l=a.copy(i).substract(s),v=a.copy(n).substract(o),p=a.copy(i).substract(o);return u.crossProduct(l)<0!==v.crossProduct(p)<0}static getLineIntersect(t,e){const n=t[0],i=t[1],s=e[0],o=e[1],r=a.copy(i).substract(n),h=a.copy(o).substract(s).perpendicular(),c=s.project(h),d=n.project(h),u=i.project(h),l=a.copy(c).substract(d),v=a.copy(u).substract(c),p=r.magnitude*l.magnitude/(l.magnitude+v.magnitude);return r.normalize().scale(p).add(n)}static getLinePoint(t,e){const n=t.length;if(n<2)return null;e>1&&(e=1),e<0&&(e=0);const i=J.getPolyLineLength(t)*e;let s=0;for(let e=1;e<n;e++)if((s+=t[e].distance(t[e-1]))>=i){const n=s-i;return a.copy(t[e]).add(a.copy(t[e-1]).substract(t[e]).normalize().scale(n))}return new a(0,0)}static getPolyLineLength(t){const e=t.length;if(e<2)return 0;let n=0;for(let i=1;i<e;i++)n+=t[i].distance(t[i-1]);return n}}var $=J;class G extends F{constructor(t){super(t),s()(this,"dash",void 0),s()(this,"text",void 0),s()(this,"arrow",void 0),s()(this,"rotate",0),s()(this,"begin",void 0),s()(this,"end",void 0),this.dash=t.dash||!1,this.text=t.text||"",this.arrow=t.arrow||!1}isInRect(){return!0}isPointIn(){const{canvas:t}=this;if(!t)return!1;if(!t.nativeEvent)return!1;if(!this.begin||!this.end)return!1;const e=t.nativeEvent,n=new a(e.clientX,e.clientY),i=t.viewportToPixelCoordinate(n);if(J.isPointInLineSegment(i,[this.begin,this.end],.1))return!0;if(this.arrow){const t=new a(0,0).rotate(this.rotate),e=new a(-10,4).rotate(this.rotate),n=new a(-10,-4).rotate(this.rotate);if(J.isPointInTriangle(a.copy(i).substract(this.end),t,e,n))return!0}if(this.text){const{graphCanvasCtx:e}=t;e.save(),e.font="14px sans-serif";const n=e.measureText(this.text).width,s=a.copy(this.end).substract(this.begin),o=s.normalize(),r=a.copy(this.begin).add(a.copy(s).scale(.5)),h=s.perpendicular().normalize();if(e.restore(),this.rotate<Math.PI/2&&this.rotate>=-Math.PI/2){const t=a.copy(r).substract(a.copy(o).scale(n/2)).add(a.copy(h).scale(17)),e=a.copy(t).add(a.copy(o).scale(n)),s=a.copy(e).substract(a.copy(h).scale(14)),c=a.copy(s).substract(a.copy(o).scale(n));if(J.isPointInPolygon(i,[t,e,s,c]))return!0}else{const t=a.copy(r).substract(a.copy(o).scale(n/2)).add(a.copy(h).scale(-17)),e=a.copy(t).add(a.copy(o).scale(n)),s=a.copy(e).substract(a.copy(h).scale(-14)),c=a.copy(s).substract(a.copy(o).scale(n));if(J.isPointInPolygon(i,[t,e,s,c]))return!0}}return!1}render(){if(!this.canvas)return;const{graphCanvasCtx:t}=this.canvas,{sourceNode:e,targetNode:n}=this;if(e.visible||n.visible){const i=e.centerPoint,s=n.centerPoint,o=[i,s];if(this.begin="rect"===e.shapeType?X(o,e.boundingRect):Y(i,e.radius,s),!this.begin)return;if(this.end="rect"===n.shapeType?X(o,n.boundingRect):Y(s,n.radius,i),!this.end)return;const r=a.copy(s).substract(i);if(t.save(),t.beginPath(),t.moveTo(this.begin.x,this.begin.y),t.lineTo(this.end.x,this.end.y),t.strokeStyle=this.active?"#e96160":"#29c1f8",t.fillStyle=this.active?"#e96160":"#29c1f8",this.dash&&t.setLineDash([4,4]),t.stroke(),this.rotate=r.xAxisAngle(),this.text){t.save();const e=a.copy(i).add(a.copy(r).scale(.5));t.font="14px sans-serif",t.textAlign="center",t.textBaseline="middle",t.translate(e.x,e.y),this.rotate<Math.PI/2&&this.rotate>=-Math.PI/2?t.rotate(this.rotate):t.rotate(this.rotate-Math.PI),t.fillText(this.text,0,-10),t.restore()}this.arrow&&(t.beginPath(),t.save(),t.translate(this.end.x,this.end.y),t.rotate(this.rotate),t.moveTo(0,0),t.lineTo(-10,4),t.lineTo(-10,-4),t.closePath(),t.fill(),t.restore()),t.restore()}}}function X(t,e){const n=e.length;for(let i=0;i<n;i++){const s=e[i],o=i===n-1?e[0]:e[i+1];if(J.isIntersect(t,[s,o]))return J.getLineIntersect([s,o],t)}}function Y(t,e,n){const i=a.copy(n).substract(t);if(i.magnitude<e)return;const s=i.xAxisAngle();return t.add(new a(e*Math.cos(s),e*Math.sin(s)))}var V=G;const q=new class extends R{constructor(...t){super(...t),s()(this,"targetNode",void 0),s()(this,"sourceNode",void 0),s()(this,"edge",void 0),s()(this,"onMouseUp",t=>{this.edge?(t.rootNode.getDescendantDF(t=>{if(t.isPointIn())return this.targetNode=t,!0}),this.targetNode&&this.targetNode!==this.sourceNode?(this.edge.targetNode=this.targetNode,this.targetNode.addEdge(this.edge),t.virtualNode.removeEdge(this.edge),this.targetNode.isUpdate=!0,this.edge=void 0,this.targetNode=void 0,this.sourceNode=void 0):(t.removeEdge(this.edge),this.edge=void 0,this.targetNode=void 0,this.sourceNode=void 0)):(t.rootNode.getDescendantDF(t=>{if(t.isPointIn())return this.sourceNode=t,!0}),this.sourceNode&&(this.edge=new V({sourceNode:this.sourceNode,targetNode:t.virtualNode,arrow:!0,text:""}),t.addEdge(this.edge))),t.repaint=!0}),s()(this,"onMouseMove",t=>{t.virtualNode.position=t.viewportToPixelCoordinate(t.mousemovePosition),this.sourceNode&&(t.virtualNode.isUpdate=!0),t.repaint=!0}),s()(this,"onUninstall",t=>{this.edge&&(t.removeEdge(this.edge),this.edge=void 0,this.targetNode=void 0,this.sourceNode=void 0),t.repaint=!0})}};var Z=q;let K=new a,Q=new a,tt=new a;class et extends F{constructor(t){super(t),s()(this,"dash",void 0),s()(this,"text",void 0),s()(this,"arrow",void 0),s()(this,"arrowStart",void 0),s()(this,"rotate",0),s()(this,"middlePoints",[]),s()(this,"centerPoint",null),s()(this,"sourceJoinPoint",void 0),s()(this,"targetJoinPoint",void 0),s()(this,"isInRect",()=>!0),this.dash=t.dash||!1,this.text=t.text||"",this.arrow=t.arrow||!1}isPointIn(){const{canvas:t}=this;if(!t)return!1;if(!t.nativeEvent)return!1;if(!this.sourceJoinPoint||!this.targetJoinPoint)return!1;const e=t.nativeEvent,n=new a(e.clientX,e.clientY),i=t.viewportToPixelCoordinate(n);if(tt.copy(i),J.isPointInPolyline(i,[this.sourceJoinPoint,...this.middlePoints,this.targetJoinPoint],.1))return!0;if(this.arrow&&this.arrowStart){const t=new a(0,0).rotate(this.rotate),e=new a(-10,4).rotate(this.rotate),n=new a(-10,-4).rotate(this.rotate);if(J.isPointInTriangle(tt.substract(this.arrowStart),t,e,n))return!0}if(this.text&&this.centerPoint){const{graphCanvasCtx:e}=t;e.font="14px sans-serif";const n=e.measureText(this.text).width,s=this.centerPoint.x-n/2,o=this.centerPoint.y-7,r=[new a(s,o),new a(s+n,o),new a(s+n,o+14),new a(s,o+14)];if(J.isPointInPolygon(i,r))return!0}return!1}render(){if(!this.canvas)return;const{graphCanvasCtx:t}=this.canvas,{sourceNode:e,targetNode:n}=this;if(e.visible||n.visible){const i=e.boundingJoinPoints,s=n.boundingJoinPoints;let o=0;if(this.sourceJoinPoint=void 0,this.targetJoinPoint=void 0,i.forEach(t=>{s.forEach(e=>{const n=t.distance(e);(o>n||!this.sourceJoinPoint||!this.targetJoinPoint)&&(o=n,this.sourceJoinPoint=t,this.targetJoinPoint=e)})}),!this.sourceJoinPoint||!this.targetJoinPoint)return;const r=this.sourceJoinPoint,h=this.targetJoinPoint;K.copy(r);const c=K.substract(e.centerPoint).normalize();Q.copy(n.centerPoint);const d=Q.substract(h).normalize();if(1===c.x||-1===c.x)if(1===d.x||-1===d.x){const t=(r.x+h.x)/2;this.middlePoints=[new a(t,r.y),new a(t,h.y)]}else this.middlePoints=[new a(h.x,r.y)];else if(1===d.x||-1===d.x)this.middlePoints=[new a(r.x,h.y)];else{const t=(r.y+h.y)/2;this.middlePoints=[new a(r.x,t),new a(h.x,t)]}if(t.save(),this.dash&&t.setLineDash([4,4]),t.beginPath(),t.moveTo(r.x,r.y),this.middlePoints.forEach(e=>{t.lineTo(e.x,e.y)}),t.lineTo(h.x,h.y),t.strokeStyle=this.active?"#e96160":"#29c1f8",t.stroke(),this.text&&(this.centerPoint=J.getLinePoint([r,...this.middlePoints,h],.5),this.centerPoint)){t.beginPath(),t.font="14px sans-serif",t.textBaseline="top";const e=t.measureText(this.text).width,n=this.centerPoint.x-e/2,i=this.centerPoint.y-7;t.rect(n,i,e,14),t.fillStyle="#fff",t.fill(),t.fillStyle=this.active?"#e96160":"#29c1f8",t.fillText(this.text,n,i)}this.arrow&&(this.arrowStart=h,this.rotate=d.xAxisAngle(),t.beginPath(),t.save(),t.translate(this.arrowStart.x,this.arrowStart.y),t.rotate(this.rotate),t.moveTo(0,0),t.lineTo(-10,4),t.lineTo(-10,-4),t.closePath(),t.fillStyle=this.active?"#e96160":"#29c1f8",t.fill(),t.restore()),t.restore()}}}var nt=et;const it=new class extends R{constructor(...t){super(...t),s()(this,"targetNode",void 0),s()(this,"sourceNode",void 0),s()(this,"edge",void 0),s()(this,"onMouseUp",t=>{this.edge?(t.rootNode.getDescendantDF(t=>{if(t.isPointIn())return this.targetNode=t,!0}),this.targetNode&&this.targetNode!==this.sourceNode?(this.edge.targetNode=this.targetNode,this.targetNode.addEdge(this.edge),t.virtualNode.removeEdge(this.edge),this.edge.arrow=!0,this.targetNode.isUpdate=!0,this.edge=void 0,this.targetNode=void 0,this.sourceNode=void 0):(t.removeEdge(this.edge),this.edge=void 0,this.targetNode=void 0,this.sourceNode=void 0)):(t.rootNode.getDescendantDF(t=>{if(t.isPointIn())return this.sourceNode=t,!0}),this.sourceNode&&(this.edge=new nt({sourceNode:this.sourceNode,targetNode:t.virtualNode,dash:!1,arrow:!1,text:"text"}),t.addEdge(this.edge))),t.repaint=!0}),s()(this,"onMouseMove",t=>{t.virtualNode.position=t.viewportToPixelCoordinate(t.mousemovePosition),this.sourceNode&&(t.virtualNode.isUpdate=!0),t.repaint=!0}),s()(this,"onUninstall",t=>{this.edge&&(t.removeEdge(this.edge),this.edge=void 0,this.targetNode=void 0,this.sourceNode=void 0),t.repaint=!0})}};var st=it;const ot=new class extends R{constructor(...t){super(...t),s()(this,"onMouseDown",t=>{let e,n;const i=Math.random();t.rootNode.getDescendantDF(s=>{e||n?s.active=!1:(s.active=s.isPointIn(),s.active&&(e=s,t.setNodeTop(s))),s.isUpdate=!0,s.edges.forEach(t=>{t.renderSign!==i&&(t.renderSign=i,t.active=!1,n||e||(t.sourceNode.visible||t.targetNode.visible)&&(t.active=t.isPointIn(),t.active&&(n=t)))})}),t.repaint=!0})}};var rt=ot;const at=new class extends R{constructor(...t){super(...t),s()(this,"onContextMenu",(t,e)=>{const n=e;t.contextMenu.hide();const i=t.getActiveNodes(),s=t.getActiveEdges();i.length?t.contextMenu.menu=[{label:"重命名",command:"rename"},{label:"删除",command:"remove"}]:s.length?t.contextMenu.menu=[{label:"删除",command:"remove"}]:t.contextMenu.menu=[{label:"放大",command:"zoomIn"},{label:"缩小",command:"zoomOut"}],t.contextMenu.show(n.clientX,n.clientY)})}};var ht=at;let ct=new u;const dt=new class extends R{constructor(...t){super(...t),s()(this,"minDragDistance",5),s()(this,"mouseDown",!1),s()(this,"onInstall",t=>{t.topCanvasMount()}),s()(this,"onUninstall",t=>{t.topCanvasCtx.clearRect(0,0,t.viewWidth,t.viewHeight),t.topCanvasUnmount()}),s()(this,"onMouseDown",(t,e)=>{const{button:n}=e;0===n&&(this.mouseDown=!0,t.topCanvasCtx.fillStyle="rgba(41, 193, 248,0.3)",t.topCanvasCtx.strokeStyle="rgb(41, 193, 248)")}),s()(this,"onMouseMove",(t,e)=>{const{mousedownPosition:n,mousemovePosition:i,topCanvasCtx:s,viewWidth:o,viewHeight:r,graphCanvasCtx:a}=t;if(!this.mouseDown)return;if(ct.copy(i),ct.substract(n).magnitude<this.minDragDistance)return;const h=t.viewportToCanvasCoordinate(n),c=t.viewportToCanvasCoordinate(i),d=new u(h.x,c.y),l=new u(c.x,h.y);let v,p,f,g;s.clearRect(0,0,o,r),s.beginPath(),s.moveTo(h.x,h.y),s.lineTo(d.x,d.y),s.lineTo(c.x,c.y),s.lineTo(l.x,l.y),s.closePath(),s.fill(),s.stroke(),n.x>i.x?n.y>i.y?(v=t.viewportToPixelCoordinate(i),f=t.viewportToPixelCoordinate(n),p=new u(f.x,v.y),g=new u(v.x,f.y)):(p=t.viewportToPixelCoordinate(n),g=t.viewportToPixelCoordinate(i),v=new u(g.x,p.y),f=new u(p.x,g.y)):n.y>i.y?(p=t.viewportToPixelCoordinate(i),g=t.viewportToPixelCoordinate(n),v=new u(g.x,p.y),f=new u(p.x,g.y)):(v=t.viewportToPixelCoordinate(n),f=t.viewportToPixelCoordinate(i),p=new u(f.x,v.y),g=new u(v.x,f.y));const m=[v,p,f,g];t.rootNode.getDescendantBF(t=>{const e=t.active;t.isWrappedInRect(m)?t.active=!0:t.active=!1,e!==t.active&&(t.isUpdate=!0)}),t.repaint=!0}),s()(this,"onMouseUp",(t,e)=>{if(!this.mouseDown)return;const{topCanvasCtx:n,viewWidth:i,viewHeight:s}=t;this.mouseDown=!1,n.clearRect(0,0,i,s)})}};var ut=dt;var lt=class{constructor(){s()(this,"width",void 0),s()(this,"height",void 0),s()(this,"position",void 0)}getBoundingRect(){const{position:{x:t,y:e},width:n,height:i}=this;return[new u(t,e),new u(t+n,e),new u(t+n,e+i),new u(t,e+i)]}getBoundingJoinPoints(){const{position:{x:t,y:e},width:n,height:i}=this;return[new u(t+n/2,e),new u(t+n,e+i/2),new u(t+n/2,e+i),new u(t,e+i/2)]}getCenterPoint(){const{position:{x:t,y:e},width:n,height:i}=this;return new u(t+n/2,e+i/2)}isInRect(t){const e=this.getBoundingRect();return!(t[0].x>e[2].x||t[2].x<e[0].x||t[0].y>e[2].y||t[2].y<e[0].y)}isWrappedInRect(t){const e=this.getBoundingRect();return t[0].x<=e[0].x&&t[0].y<=e[0].y&&t[2].x>=e[2].x&&t[2].y>=e[2].y}};class vt extends b{constructor(t){super(t),s()(this,"shapeType","rect"),s()(this,"width",void 0),s()(this,"height",void 0),s()(this,"minWidth",void 0),s()(this,"minHeight",void 0),s()(this,"text",void 0),this.width=t.width||100,this.height=t.height||100,this.minWidth=t.minWidth||30,this.minHeight=t.minHeight||30,this.text=t.text||""}getBoundingJoinPoints(){return[]}getBoundingRect(){return[]}getCenterPoint(){return new u(0,0)}get vertexes(){return this.getBoundingRect()}get boundingRect(){return this.getBoundingRect()}get boundingJoinPoints(){return this.getBoundingJoinPoints()}get centerPoint(){return this.getCenterPoint()}isInRect(t){return!1}isPointIn(){const{canvas:t}=this;if(!t)return!1;if(!t.nativeEvent)return!1;const e=t.nativeEvent,n=t.viewportToPixelCoordinate(new u(e.clientX,e.clientY));return $.isPointInRect(n,this.position,this.width,this.height)}get joinPoint(){const{x:t,y:e}=this.position;return new u(t+this.width/2,e+this.height/2)}render(){if(!this.canvas)return;const t=this.cacheCanvas.getContext("2d");this.cacheCanvas.width=this.width+4,this.cacheCanvas.height=this.height+4,t.rect(2,2,this.width,this.height),t.strokeStyle="#29c1f8",t.fillStyle="#fff",t.lineWidth=1,t.fill(),t.stroke(),t.textBaseline="middle",t.textAlign="center",t.font="14px serif",t.fillStyle="#29c1f8",t.fillText(this.text,this.width/2+2,this.height/2+2),this.canvas.repaint=!0}update(){if(!this.canvas)return;const{graphCanvasCtx:t}=this.canvas,{x:e,y:n}=this.position;t.save(),this.active&&(t.shadowBlur=5,t.shadowColor="rgba(255,0,0,0.8)"),t.drawImage(this.cacheCanvas,e-2,n-2),t.restore()}updateRender(){}}M(vt,[lt]);class pt extends vt{constructor(...t){super(...t),s()(this,"isGroup",!0)}render(){}update(){if(!this.canvas)return;const{graphCanvasCtx:t}=this.canvas,{x:e,y:n}=this.position;t.rect(e,n,this.width,this.height),t.save(),this.active&&(t.shadowBlur=5,t.shadowColor="rgba(255,0,0,0.8)"),t.strokeStyle="#066df2",t.stroke(),t.restore()}}var ft=pt;var gt=new class extends R{constructor(...t){super(...t),s()(this,"canvas",void 0),s()(this,"onContextMenu",(t,e)=>{const n=e,i=t.getActiveNodes();t.contextMenu.hide(),i.length&&(t.contextMenu.menu=[{label:"添加到组",command:"addToGroup"}],t.contextMenu.show(n.clientX,n.clientY))}),s()(this,"onInstall",t=>{this.canvas=t,t.eventEmitter.on("canvas:menu",this.onAddToGroup)}),s()(this,"onUninstall",t=>{t.eventEmitter.off("canvas:menu",this.onAddToGroup)}),s()(this,"onAddToGroup",t=>{if("addToGroup"!==t)return;const e=this.canvas.rootNode.children.filter(t=>t.active);if(!e.length)return;const n=new ft({width:200,height:200,id:"group",x:0,y:0});let i=Number.MAX_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,o=Number.MIN_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER;e.forEach(t=>{t.boundingRect.forEach(t=>{t.x<i&&(i=t.x),t.x>o&&(o=t.x),t.y<s&&(s=t.y),t.y>r&&(r=t.y)}),t.parent&&t.parent.removeChild(t,!1),n.addChild(t)}),n.width=o-i+40,n.height=r-s+40,n.position.x=i-20,n.position.y=s-20,this.canvas.addNode(n)})}};const mt=new u(-3,-3);const wt=new class extends R{constructor(...t){super(...t),s()(this,"activeNode",void 0),s()(this,"flag",!1),s()(this,"activeAnchorIndex",-1),s()(this,"onInstall",t=>{t.topCanvasMount()}),s()(this,"onUninstall",t=>{t.topCanvasCtx.clearRect(0,0,t.viewWidth,t.viewHeight),t.topCanvasUnmount()}),s()(this,"onMouseUp",t=>{this.activeAnchorIndex=-1,L.onMouseUp(t)}),s()(this,"onMouseDown",t=>{this.activeAnchorIndex=this.getActiveAnchorIndex(t),-1===this.activeAnchorIndex&&(rt.onMouseDown(t),L.onMouseDown(t),this.activeNode=t.getActiveNodes()[0])}),s()(this,"onMouseMove",(t,e)=>{const n=this.activeNode;if(this.activeAnchorIndex>-1&&n){const i=e,s=t.viewportToPixelCoordinate(new u(i.clientX,i.clientY)),o=n.boundingRect;n.isUpdate=!0,t.repaint=!0;let r=n.width,a=n.height;switch(this.activeAnchorIndex){case 0:r=o[2].x-s.x,a=o[2].y-s.y,r>=n.minWidth&&(n.position.x=s.x,n.width=r),a>=n.minHeight&&(n.position.y=s.y,n.height=a);break;case 1:r=s.x-o[3].x,a=o[3].y-s.y,r>=n.minWidth&&(n.width=r),a>=n.minHeight&&(n.position.y=s.y,n.height=a);break;case 2:r=s.x-o[0].x,a=s.y-o[0].y,r>=n.minWidth&&(n.width=r),a>=n.minHeight&&(n.height=a);break;case 3:r=o[1].x-s.x,a=s.y-o[1].y,r>=n.minWidth&&(n.position.x=s.x,n.width=r),a>=n.minHeight&&(n.height=a);break;case 4:(a=o[2].y-s.y)>=n.minHeight&&(n.position.y=s.y,n.height=a);break;case 5:(r=s.x-o[0].x)>=n.minWidth&&(n.width=r);break;case 6:(a=s.y-o[0].y)>=n.minHeight&&(n.height=a);break;case 7:(r=o[2].x-s.x)>=n.minWidth&&(n.position.x=s.x,n.width=r)}n.render()}else{const e=this.getActiveAnchorIndex(t);let n="default";if(e>-1)switch(e){case 0:n="nwse-resize";break;case 1:n="nesw-resize";break;case 2:n="nwse-resize";break;case 3:n="nesw-resize";break;case 4:n="ns-resize";break;case 5:n="ew-resize";break;case 6:n="ns-resize";break;case 7:n="ew-resize"}else L.onMouseMove(t);t.wrapper.style.cursor=n}}),s()(this,"onUpdate",t=>{if(t.topCanvasCtx.clearRect(0,0,t.viewWidth,t.viewHeight),this.activeNode){const e=[...this.activeNode.boundingRect,...this.activeNode.boundingJoinPoints];t.topCanvasCtx.save(),t.topCanvasCtx.fillStyle="#2D8CF5",t.topCanvasCtx.beginPath(),e.forEach(e=>{const n=t.pixelToCanvasCoordinate(e);t.topCanvasCtx.rect(n.x-3,n.y-3,6,6),t.topCanvasCtx.fill()}),t.topCanvasCtx.restore()}})}getActiveAnchorIndex(t){if(!this.activeNode)return-1;const e=[...this.activeNode.boundingRect,...this.activeNode.boundingJoinPoints];let n=0;return e.find((e,i)=>{const s=t.pixelToViewportCoordinate(e).add(mt);return n=i,$.isPointInRect(t.mousemovePosition,s,6,6)})?n:-1}};const xt="mode.default",yt={[xt]:[rt,L,z,H,ht],"mode.view":[W,H],"mode.create.edge":[rt,H,Z,W],"mode.create.L":[rt,H,st,W],"mode.area.pick":[H,ut,gt],"mode.border":[wt,H]};var bt=yt,Ct=n(5),Et=n.n(Ct);class Pt{constructor(t){s()(this,"mounted",!1),s()(this,"_running",!1),s()(this,"_animationFrameId",0),s()(this,"name","application"),s()(this,"eventEmitter",f),s()(this,"nativeEvent",null),s()(this,"optimize",!0),s()(this,"interactionMode",xt),s()(this,"container",void 0),s()(this,"wrapper",document.createElement("div")),s()(this,"containerClientRect",void 0),s()(this,"graphCanvas",document.createElement("canvas")),s()(this,"graphCanvasCtx",void 0),s()(this,"domCanvas",document.createElement("div")),s()(this,"topCanvas",document.createElement("canvas")),s()(this,"topCanvasMounted",!1),s()(this,"topCanvasCtx",void 0),s()(this,"virtualNode",new I({x:0,y:0,id:"vn"})),s()(this,"mousedownPosition",new a(0,0)),s()(this,"mouseupPosition",new a(0,0)),s()(this,"mousemovePosition",new a(0,0)),s()(this,"ro",void 0),s()(this,"viewWidth",0),s()(this,"viewHeight",0),s()(this,"canvasWidth",0),s()(this,"canvasHeight",0),s()(this,"canvasScale",void 0),s()(this,"maxScale",void 0),s()(this,"minScale",void 0),s()(this,"repaint",!1),s()(this,"contextMenu",new v(this)),s()(this,"rootNode",new I({x:0,y:0,id:"rootNode"})),s()(this,"handleClick",t=>{this.nativeEvent=t;const e=bt[this.interactionMode];e&&e.forEach(e=>{e.onClick(this,t)}),this.eventEmitter.emit("canvas:click",t)}),s()(this,"handleWheel",t=>{const e=bt[this.interactionMode];e&&e.forEach(e=>{e.onWheel(this,t)}),this.eventEmitter.emit("canvas:wheel",t)}),s()(this,"handleMouseDown",t=>{this.nativeEvent=t,this.mousedownPosition=new a(t.clientX,t.clientY);const e=bt[this.interactionMode];e&&e.forEach(e=>{e.onMouseDown(this,t)}),this.eventEmitter.emit("canvas:mousedown",t)}),s()(this,"handleMouseMove",P(t=>{this.nativeEvent=t,this.mousemovePosition=new a(t.clientX,t.clientY);const e=bt[this.interactionMode];e&&e.forEach(e=>{e.onMouseMove(this,t)}),this.optimizeNode(),this.eventEmitter.emit("canvas:mousemove",t)})),s()(this,"handleMouseUp",t=>{this.nativeEvent=t,this.mouseupPosition=new a(t.clientX,t.clientY);const e=bt[this.interactionMode];e&&e.forEach(e=>{e.onMouseUp(this,t)}),this.eventEmitter.emit("canvas:mouseup",t)}),s()(this,"handleDragOver",t=>{const e=bt[this.interactionMode];e&&e.forEach(e=>{e.onDragOver(this,t)})}),s()(this,"handleDrop",t=>{const e=bt[this.interactionMode];e&&e.forEach(e=>{e.onDrop(this,t)})}),s()(this,"handleContextMenu",t=>{t.preventDefault();const e=bt[this.interactionMode];e&&e.forEach(e=>{e.onContextMenu(this,t)})}),this.container=t.container,this.wrapper.className=Et.a.topology,this.graphCanvasCtx=this.graphCanvas.getContext("2d"),this.topCanvasCtx=this.topCanvas.getContext("2d"),this.canvasScale=t.scale||1,this.maxScale=t.maxScale||5,this.minScale=t.minScale||.1,this.rootNode.canvas=this,this.ro=new _.a((t,e)=>{for(const e of t){const{width:t,height:n}=e.contentRect;this.viewWidth=t,this.viewHeight=n,this.canvasWidth=t/this.canvasScale,this.canvasHeight=n/this.canvasScale,this.containerClientRect=this.container.getBoundingClientRect()}this.mount(),this.render(),this.optimizeNode(),this.repaint=!0}),this.ro.observe(this.container),this.nativeEventInit(),this.globalEventInit(),this.setMode(t.mode||xt)}setZoom(t){this.canvasScale=t,this.canvasWidth=this.viewWidth/this.canvasScale,this.canvasHeight=this.viewHeight/this.canvasScale,this.render(),this.optimizeNode(),this.repaint=!0}nativeEventInit(){this.wrapper.addEventListener("click",this.handleClick),this.wrapper.addEventListener("mousedown",this.handleMouseDown),this.wrapper.addEventListener("wheel",this.handleWheel),this.wrapper.addEventListener("dragover",this.handleDragOver),this.wrapper.addEventListener("drop",this.handleDrop),this.wrapper.addEventListener("contextmenu",this.handleContextMenu),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp)}globalEventInit(){}destroy(){this.wrapper.removeEventListener("click",this.handleClick),this.wrapper.removeEventListener("mousedown",this.handleMouseDown),this.wrapper.removeEventListener("wheel",this.handleWheel),this.wrapper.removeEventListener("dragover",this.handleDragOver),this.wrapper.removeEventListener("drop",this.handleDrop),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),this.ro.unobserve(this.container),this.ro.disconnect(),this.unmount(),this.removeAllNode()}addNode(t){this.rootNode.hasChild(t)||(t.visible=t.isInRect(this.canvasVisibleRect),this.rootNode.addChild(t),this.repaint=!0)}setNodeTop(t){const e=t.parent;if(!e)return;const n=e.lastChild&&e.lastChild.zIndex||0;t.zIndex=Math.max(n,t.zIndex),e.removeChild(t,!1),e.addChild(t),t instanceof C&&(t.unmount(),t.mount()),this.repaint=!0}getActiveNodes(){return this.rootNode.getActiveDescendant()}removeNode(t,e=!0){if(!this.rootNode.hasDescendant(t))return;if(!t.parent)return;t.parent.removeChild(t,e),[...t.edges].forEach(t=>{this.removeEdge(t)}),this.repaint=!0}removeAllNode(t=!0){this.rootNode.removeAllChild(t)}addEdge(t){t.sourceNode.addEdge(t),t.targetNode.addEdge(t),t.canvas=this,this.repaint=!0}removeEdge(t){t.sourceNode.removeEdge(t),t.targetNode.removeEdge(t),t.canvas=void 0,this.repaint=!0}getActiveEdges(){const t=[],e=Math.random();return this.rootNode.getDescendantBF(n=>{n.edges.forEach(n=>{n.renderSign!==e&&(n.renderSign=e,n.active&&t.push(n))})}),t}viewportToCanvasCoordinate(t){this.containerClientRect||(this.containerClientRect=this.container.getBoundingClientRect());const{top:e,left:n}=this.containerClientRect;return t.clone().substract(new a(n,e))}canvasToViewportCoordinate(t){this.containerClientRect||(this.containerClientRect=this.container.getBoundingClientRect());const{top:e,left:n}=this.containerClientRect;return t.clone().add(new a(n,e))}canvasToPixelCoordinate(t){return t.clone().scale(1/this.canvasScale)}pixelToCanvasCoordinate(t){return t.clone().scale(this.canvasScale)}viewportToPixelCoordinate(t){return this.canvasToPixelCoordinate(this.viewportToCanvasCoordinate(t))}pixelToViewportCoordinate(t){return this.canvasToViewportCoordinate(this.pixelToCanvasCoordinate(t))}get canvasVisibleRect(){return[new a(0,0),new a(this.canvasWidth,0),new a(this.canvasWidth,this.canvasHeight),new a(0,this.canvasHeight)]}zoomIn(t){t=t?this.viewportToCanvasCoordinate(t):new a(this.viewWidth/2,this.viewHeight/2);const e=this.canvasToPixelCoordinate(t);this.canvasScale+=.15,this.canvasScale=this.canvasScale>this.maxScale?this.maxScale:this.canvasScale;const n=this.canvasToPixelCoordinate(t).substract(e);this.canvasWidth=this.viewWidth/this.canvasScale,this.canvasHeight=this.viewHeight/this.canvasScale,this.rootNode.children.forEach(t=>{t.translate(n)}),this.optimizeNode(),this.render(),this.repaint=!0,this.eventEmitter.emit("canvas:zoom")}zoomOut(t){t=t?this.viewportToCanvasCoordinate(t):new a(this.viewWidth/2,this.viewHeight/2);const e=this.canvasToPixelCoordinate(t);this.canvasScale-=.15,this.canvasScale=this.canvasScale<this.minScale?this.minScale:this.canvasScale;const n=this.canvasToPixelCoordinate(t).substract(e);this.canvasWidth=this.viewWidth/this.canvasScale,this.canvasHeight=this.viewHeight/this.canvasScale,this.rootNode.children.forEach(t=>{t.translate(n)}),this.optimizeNode(),this.render(),this.repaint=!0,this.eventEmitter.emit("canvas:zoom")}setMode(t){if(!bt[t])return void console.log(`该模式不存在:${t}`);let e=bt[this.interactionMode];e&&e.forEach(t=>{t.onUninstall(this)}),this.interactionMode=t,(e=bt[t])&&e.forEach(t=>{t.onInstall(this)})}optimizeNode(){if(!this.optimize)return;const t=this.canvasVisibleRect;this.rootNode.getDescendantBF().forEach(e=>{e.visible=e.isInRect(t)})}render(){Object.assign(this.domCanvas.style,{width:`${this.canvasWidth}px`,height:`${this.canvasHeight}px`,left:`${(this.viewWidth-this.canvasWidth)/2}px`,top:`${(this.viewHeight-this.canvasHeight)/2}px`,transform:`scale(${this.canvasScale})`}),this.graphCanvas.width=this.topCanvas.width=this.viewWidth,this.graphCanvas.height=this.topCanvas.height=this.viewHeight}mount(){this.mounted||(this.wrapper.appendChild(this.graphCanvas),this.wrapper.appendChild(this.domCanvas),this.container.appendChild(this.wrapper),this.eventEmitter.emit("canvas:mounted"),this.mounted=!0)}topCanvasMount(){this.topCanvasMounted||(this.wrapper.appendChild(this.topCanvas),this.topCanvasMounted=!0)}topCanvasUnmount(){this.topCanvasMounted&&(this.wrapper.removeChild(this.topCanvas),this.topCanvasMounted=!1)}unmount(){this.mounted&&(this.container.removeChild(this.wrapper),this.mounted=!1)}start(){this._running||(this._running=!0,this.loop())}stop(){this._running&&(cancelAnimationFrame(this._animationFrameId),this._running=!1)}loop(){this._running&&(this._animationFrameId=requestAnimationFrame(()=>{if(this.repaint){this.graphCanvasCtx.clearRect(0,0,this.viewWidth,this.viewHeight),this.graphCanvasCtx.save(),this.graphCanvasCtx.scale(this.canvasScale,this.canvasScale),this.renderNodes(),this.graphCanvasCtx.restore();const t=bt[this.interactionMode];t&&t.forEach(t=>{t.onUpdate(this)}),this.repaint=!1}this.loop()}))}renderNodes(){this.rootNode.getDescendantBF(t=>{t.edges.forEach(e=>{e.renderSign!==this._animationFrameId&&(e.sourceNode===t?e.targetNode.depth<=t.depth&&(e.render(),e.renderSign=this._animationFrameId):e.sourceNode.depth<=t.depth&&(e.render(),e.renderSign=this._animationFrameId))}),t instanceof y&&t.visible&&t.update(),t instanceof C&&(t.visible?(t.mount(),t.isUpdate&&(t.update(),t.isUpdate=!1)):t.unmount())}),this.virtualNode.edges.forEach(t=>{t.render()})}}class Nt extends E{getBoundingRect(){return[]}getBoundingJoinPoints(){return[]}getCenterPoint(){return new u(0,0)}get vertexes(){return this.getBoundingRect()}get joinPoint(){return this.getCenterPoint()}get boundingRect(){return this.getBoundingRect()}get boundingJoinPoints(){return this.getBoundingJoinPoints()}get centerPoint(){return this.getCenterPoint()}constructor(t){super(t),s()(this,"shapeType","rect"),s()(this,"width",void 0),s()(this,"height",void 0),s()(this,"minWidth",void 0),s()(this,"minHeight",void 0),s()(this,"text",void 0),this.width=t.width||100,this.height=t.height||100,this.minWidth=t.minWidth||30,this.minHeight=t.minHeight||30,this.text=t.text||""}isPointIn(){const{canvas:t}=this;if(!t)return!1;if(!t.nativeEvent)return!1;const e=t.nativeEvent,n=t.viewportToPixelCoordinate(new u(e.clientX,e.clientY));return $.isPointInRect(n,this.position,this.width,this.height)}render(){this.$el.innerHTML=`<div style="height:100%;\n                                      display:flex;\n                                      align-items:center;\n                                      justify-content:center;\n                                      border:1px solid #29c1f8;\n                                      box-sizing: border-box;\n                                      font-size:12px;\n                                      user-select: none;\n                                      color:#29c1f8;">${this.text}</div>`}update(){const{x:t,y:e}=this.position,{width:n,height:i,active:s}=this;Object.assign(this.$el.style,{transform:`translate3d(${t}px,${e}px,0)`,width:`${n}px`,height:`${i}px`,boxShadow:s?"0 0 5px 0 rgba(255,0,0,0.8)":"none"})}}M(Nt,[lt]);class Mt extends b{get boundingJoinPoints(){return this.getBoundingJoinPoints()}get boundingRect(){return this.getBoundingRect()}get centerPoint(){return this.getCenterPoint()}get vertexes(){return this.getBoundingRect()}constructor(t){super(t),s()(this,"shapeType","circle"),s()(this,"radius",void 0),s()(this,"text",void 0),this.radius=t.radius,this.text=t.text||""}isPointIn(){const{canvas:t,centerPoint:e,radius:n}=this;if(!t)return!1;if(!t.nativeEvent)return!1;const i=t.nativeEvent,s=t.viewportToPixelCoordinate(new u(i.clientX,i.clientY));return $.isPointInCircle(s,e,n)}render(){const{radius:t,canvas:e,active:n}=this;if(!e)return;const i=2*t;this.cacheCanvas.width=i+2,this.cacheCanvas.height=i+2;const s=this.cacheCanvas.getContext("2d");s.beginPath(),s.arc(t+1,t+1,t,0,2*Math.PI),s.strokeStyle="#29c1f8",s.fillStyle="#fff",s.lineWidth=2,s.stroke(),s.fill(),this.text&&(s.textBaseline="middle",s.textAlign="center",s.font="14px serif",s.fillStyle="#29c1f8",s.fillText(this.text,t+1,t+1)),e.repaint=!0}update(){if(!this.canvas)return;const{graphCanvasCtx:t}=this.canvas,{x:e,y:n}=this.position;t.save(),this.active&&(t.shadowBlur=5,t.shadowColor="rgba(255,0,0,0.8)"),t.drawImage(this.cacheCanvas,e-1,n-1),t.restore()}getBoundingJoinPoints(){return[]}getBoundingRect(){return[]}getCenterPoint(){return new u(0,0)}}M(Mt,[class{constructor(){s()(this,"position",void 0),s()(this,"radius",void 0)}getBoundingRect(){const{radius:t,position:{x:e,y:n}}=this,i=2*t;return[new u(e,n),new u(e+i,n),new u(e+i,n+i),new u(e,n+i)]}getBoundingJoinPoints(){const{radius:t,position:{x:e,y:n}}=this,i=2*t;return[new u(e+t,n),new u(e+i,n+t),new u(e+t,n+i),new u(e,n+t)]}getCenterPoint(){const{position:{x:t,y:e},radius:n}=this;return new u(t+n,e+n)}isInRect(t){const e=this.getBoundingRect();return!(t[0].x>e[2].x||t[2].x<e[0].x||t[0].y>e[2].y||t[2].y<e[0].y)}isWrappedInRect(t){const e=this.getBoundingRect();return t[0].x<=e[0].x&&t[0].y<=e[0].y&&t[2].x>=e[2].x&&t[2].y>=e[2].y}}]);class _t{constructor(t,e,n){s()(this,"id",void 0),s()(this,"data",void 0),s()(this,"children",[]),s()(this,"parent",void 0),this.id=t,this.data=e,n&&n.addChild(this)}addChild(t){return this.addChildAt(t,this.children.length)}addChildAt(t,e){return e>=0&&e<=this.children.length?(t.parent=this,this.children.splice(e,0,t),t):void 0}getChildById(t){return this.children.find(e=>e.id===t)}getDescendantDF(t){const e=[],n=[...this.children];for(;n.length;){const i=n.pop();if(e.push(i),n.push(...i.children),t&&t(i))break}return e}getDescendantBF(t){const e=[],n=[...this.children];for(;n.length;){const i=n.shift();if(e.push(i),n.push(...i.children),t&&t(i))break}return e}get root(){let t=this;for(;void 0!==t.parent;)t=t.parent;return t}get depth(){let t=0,e=this;for(;void 0!==e.parent;)e=e.parent,t++;return t}get firstChild(){return this.children[0]}get lastChild(){return this.children[this.children.length-1]}}n.d(e,"Canvas",function(){return Pt}),n.d(e,"ContextMenu",function(){return v}),n.d(e,"EventEmitter",function(){return p}),n.d(e,"globalEvent",function(){return f}),n.d(e,"CanvasNode",function(){return y}),n.d(e,"DomNode",function(){return C}),n.d(e,"Edge",function(){return F}),n.d(e,"Node",function(){return w}),n.d(e,"MODE_DEFAULT",function(){return xt}),n.d(e,"MODE_VIEW",function(){return"mode.view"}),n.d(e,"MODE_CREATE_EDGE",function(){return"mode.create.edge"}),n.d(e,"MODE_CREATE_L",function(){return"mode.create.L"}),n.d(e,"MODE_AREA_PICK",function(){return"mode.area.pick"}),n.d(e,"MODE_BORDER",function(){return"mode.border"}),n.d(e,"modes",function(){return yt}),n.d(e,"selectInteraction",function(){return ot}),n.d(e,"createEdgeInteraction",function(){return q}),n.d(e,"createLInteraction",function(){return it}),n.d(e,"dragInteraction",function(){return O}),n.d(e,"dropInteraction",function(){return k}),n.d(e,"menuInteration",function(){return at}),n.d(e,"moveCanvasInteraction",function(){return U}),n.d(e,"wheelZoomInteraction",function(){return j}),n.d(e,"Interaction",function(){return D}),n.d(e,"areaPickInteraction",function(){return dt}),n.d(e,"RectDomNode",function(){return Nt}),n.d(e,"RectCanvasNode",function(){return vt}),n.d(e,"CircleCanvasNode",function(){return Mt}),n.d(e,"Group",function(){return pt}),n.d(e,"Line",function(){return G}),n.d(e,"L",function(){return et}),n.d(e,"Math2d",function(){return J}),n.d(e,"Vector2d",function(){return a}),n.d(e,"throttle",function(){return P}),n.d(e,"imgLoad",function(){return N}),n.d(e,"applyMixins",function(){return M}),n.d(e,"TreeNode",function(){return _t})}])});